import{_ as K,o as q,a as p,c as m,b as e,t as a,p as D,f as d,v as u,k as W,F as j,r as M,g as _,n as G,j as Q,w as B,e as P,d as v}from"./index-DxPLqLYP.js";const X={class:"clients-page"},Y={class:"page-header"},Z={class:"header-row"},ee={class:"header-actions"},le=["disabled"],te={key:0,class:"client-form-panel"},se={class:"client-form-grid"},ae={class:"form-field"},ne={class:"form-field"},oe={class:"form-field"},ie={class:"form-field"},de={class:"form-field"},ue={class:"form-field"},re={class:"form-field"},pe={class:"form-field"},me=["value"],ve={class:"form-field"},ce={class:"form-field"},fe={class:"form-field"},_e={class:"form-field"},be={class:"form-field"},ye={class:"form-field"},ge={class:"form-field"},he={class:"form-field form-notes"},ke={class:"form-actions"},Ce=["disabled"],we={class:"search-bar"},xe={key:2,class:"results-summary"},Pe={class:"table-container"},Se={class:"clients-table"},Ue={key:0},Ve={key:1},$e=["onClick"],Le={class:"client-name"},Ee={class:"member-id"},ze=["on_click"],Fe={key:3,class:"pagination"},Ne=["disabled"],De={class:"page-info"},je=["disabled"],Me={class:"detail-panel"},Be={class:"detail-header"},Ae={class:"detail-grid"},Ie={class:"detail-item"},Te={class:"detail-item"},Oe={class:"detail-item"},Re={class:"detail-item"},He={class:"detail-item"},Je={class:"detail-item"},Ke={class:"detail-item"},qe={class:"detail-item"},We={class:"detail-item"},Ge={class:"detail-item"},Qe={class:"detail-item"},Xe={class:"detail-item"},Ye={class:"detail-item"},Ze={class:"detail-item"},el={key:0,class:"detail-notes"},ll={class:"detail-actions"},tl={__name:"ClientsList",setup(sl){const b=v([]),S=v(!0),y=v(0),k=v(25),c=v(0),w=v(""),U=v(""),C=v(!1),g=v(null),n=v(null),V=v(""),E=v(!1),A=["Buffalo Lake","East Prairie","Elizabeth","Fishing Lake","Gift Lake","Kikino","Paddle Prairie","Peavine"],z=()=>({first_name:"",last_name:"",member_id:"",email:"",phone_home:"",phone_work:"",phone_cell:"",address_1:"",city:"",province:"AB",postal_code:"",date_of_birth:"",settlement:"",org_name:"",job_title:"",notes:""}),s=v(z());function x(i,l=!1){V.value=i,E.value=l,setTimeout(()=>{V.value=""},3e3)}async function h(){S.value=!0;try{const i=new URLSearchParams;i.set("limit",k.value),i.set("offset",c.value),U.value&&i.set("search",U.value);const l=await P.get(`/clients?${i.toString()}`);l.success&&(b.value=l.data,y.value=l.total)}catch{b.value=[]}finally{S.value=!1}}function F(){U.value=w.value.trim(),c.value=0,h()}function I(){w.value="",U.value="",c.value=0,h()}function T(){c.value=Math.max(0,c.value-k.value),h()}function O(){c.value=c.value+k.value,h()}async function R(i){var l,r;try{const o=await P.get(`/clients/${i}`);o.success&&(n.value=o.client)}catch(o){x(((r=(l=o.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to load client",!0)}}async function N(i){var l,r;try{const o=await P.get(`/clients/${i}`);if(o.success){const t=o.client;g.value=t.id,n.value=null,C.value=!1,s.value={first_name:t.first_name||"",last_name:t.last_name||"",member_id:t.member_id||"",email:t.email||"",phone_home:t.phone_home||"",phone_work:t.phone_work||"",phone_cell:t.phone_cell||"",address_1:t.address_1||"",city:t.city||"",province:t.province||"AB",postal_code:t.postal_code||"",date_of_birth:t.date_of_birth?t.date_of_birth.split("T")[0]:"",settlement:t.settlement||"",org_name:t.org_name||"",job_title:t.job_title||"",notes:t.notes||""}}}catch(o){x(((r=(l=o.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to load client",!0)}}async function H(){var l,r,o,t;if(!((l=s.value.first_name)!=null&&l.trim())||!((r=s.value.last_name)!=null&&r.trim()))return;const i={};for(const[f,L]of Object.entries(s.value))L!==""&&L!==null&&(i[f]=L);try{if(g.value){const f=await P.patch(`/clients/${g.value}`,i);f.success&&(x(f.message),$(),h())}else{const f=await P.post("/clients",i);f.success&&(x(f.message),$(),h())}}catch(f){x(((t=(o=f.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to save client",!0)}}function $(){C.value=!1,g.value=null,s.value=z()}function J(){if(b.value.length===0)return;const i=["Last Name,First Name,Member ID,Email,Phone (Cell),Phone (Home),Settlement,City"];b.value.forEach(t=>{i.push([`"${(t.last_name||"").replace(/"/g,'""')}"`,`"${(t.first_name||"").replace(/"/g,'""')}"`,`"${(t.member_id||"").replace(/"/g,'""')}"`,`"${(t.email||"").replace(/"/g,'""')}"`,`"${(t.phone_cell||"").replace(/"/g,'""')}"`,`"${(t.phone_home||"").replace(/"/g,'""')}"`,`"${(t.settlement||"").replace(/"/g,'""')}"`,`"${(t.city||"").replace(/"/g,'""')}"`].join(","))});const l=new Blob([i.join(`
`)],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(l),o=document.createElement("a");o.href=r,o.download=`Clients_Export_${new Date().toISOString().split("T")[0]}.csv`,o.click(),URL.revokeObjectURL(r)}return q(()=>{h()}),(i,l)=>{var r,o;return p(),m("div",X,[e("div",Y,[e("div",Z,[l[21]||(l[21]=e("div",null,[e("h1",null,"Clients"),e("p",null,"Manage client records")],-1)),e("div",ee,[e("goa-button",{type:"secondary",size:"compact",on_click:J,disabled:b.value.length===0}," Export CSV ",40,le),e("goa-button",{type:"primary",on_click:l[0]||(l[0]=t=>C.value=!C.value)},a(C.value?"Cancel":"New Client"),33)])])]),C.value||g.value?(p(),m("div",te,[e("h3",null,a(g.value?"Edit Client":"New Client"),1),e("div",se,[e("div",ae,[l[22]||(l[22]=e("label",null,[D("First Name "),e("span",{class:"required"},"*")],-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[1]||(l[1]=t=>s.value.first_name=t),placeholder:"First name"},null,512),[[u,s.value.first_name]])]),e("div",ne,[l[23]||(l[23]=e("label",null,[D("Last Name "),e("span",{class:"required"},"*")],-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[2]||(l[2]=t=>s.value.last_name=t),placeholder:"Last name"},null,512),[[u,s.value.last_name]])]),e("div",oe,[l[24]||(l[24]=e("label",null,"Member ID",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[3]||(l[3]=t=>s.value.member_id=t),placeholder:"e.g. 1-891133"},null,512),[[u,s.value.member_id]])]),e("div",ie,[l[25]||(l[25]=e("label",null,"Email",-1)),d(e("input",{type:"email",class:"form-input","onUpdate:modelValue":l[4]||(l[4]=t=>s.value.email=t),placeholder:"email@example.com"},null,512),[[u,s.value.email]])]),e("div",de,[l[26]||(l[26]=e("label",null,"Phone (Home)",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[5]||(l[5]=t=>s.value.phone_home=t),placeholder:"Phone home"},null,512),[[u,s.value.phone_home]])]),e("div",ue,[l[27]||(l[27]=e("label",null,"Phone (Work)",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[6]||(l[6]=t=>s.value.phone_work=t),placeholder:"Phone work"},null,512),[[u,s.value.phone_work]])]),e("div",re,[l[28]||(l[28]=e("label",null,"Phone (Cell)",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[7]||(l[7]=t=>s.value.phone_cell=t),placeholder:"Cell phone"},null,512),[[u,s.value.phone_cell]])]),e("div",pe,[l[30]||(l[30]=e("label",null,"Settlement",-1)),d(e("select",{class:"form-input","onUpdate:modelValue":l[8]||(l[8]=t=>s.value.settlement=t)},[l[29]||(l[29]=e("option",{value:""},"— Select —",-1)),(p(),m(j,null,M(A,t=>e("option",{key:t,value:t},a(t),9,me)),64))],512),[[W,s.value.settlement]])]),e("div",ve,[l[31]||(l[31]=e("label",null,"Address",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[9]||(l[9]=t=>s.value.address_1=t),placeholder:"Street address"},null,512),[[u,s.value.address_1]])]),e("div",ce,[l[32]||(l[32]=e("label",null,"City",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[10]||(l[10]=t=>s.value.city=t),placeholder:"City"},null,512),[[u,s.value.city]])]),e("div",fe,[l[33]||(l[33]=e("label",null,"Province",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[11]||(l[11]=t=>s.value.province=t),placeholder:"AB"},null,512),[[u,s.value.province]])]),e("div",_e,[l[34]||(l[34]=e("label",null,"Postal Code",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[12]||(l[12]=t=>s.value.postal_code=t),placeholder:"T0A 0A0"},null,512),[[u,s.value.postal_code]])]),e("div",be,[l[35]||(l[35]=e("label",null,"Date of Birth",-1)),d(e("input",{type:"date",class:"form-input","onUpdate:modelValue":l[13]||(l[13]=t=>s.value.date_of_birth=t)},null,512),[[u,s.value.date_of_birth]])]),e("div",ye,[l[36]||(l[36]=e("label",null,"Organization",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[14]||(l[14]=t=>s.value.org_name=t),placeholder:"Organization name"},null,512),[[u,s.value.org_name]])]),e("div",ge,[l[37]||(l[37]=e("label",null,"Job Title",-1)),d(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[15]||(l[15]=t=>s.value.job_title=t),placeholder:"Job title"},null,512),[[u,s.value.job_title]])])]),e("div",he,[l[38]||(l[38]=e("label",null,"Notes",-1)),d(e("textarea",{class:"form-input form-textarea","onUpdate:modelValue":l[16]||(l[16]=t=>s.value.notes=t),rows:"2",placeholder:"Internal notes..."},null,512),[[u,s.value.notes]])]),e("div",ke,[e("goa-button",{type:"primary",size:"compact",disabled:!((r=s.value.first_name)!=null&&r.trim())||!((o=s.value.last_name)!=null&&o.trim()),on_click:H},a(g.value?"Save Changes":"Create Client"),41,Ce),e("goa-button",{type:"tertiary",size:"compact",on_click:$},"Cancel",32)])])):_("",!0),V.value?(p(),m("div",{key:1,class:G(["feedback",E.value?"feedback-error":"feedback-success"])},a(V.value),3)):_("",!0),e("div",we,[d(e("input",{type:"text",class:"search-input-large","onUpdate:modelValue":l[17]||(l[17]=t=>w.value=t),placeholder:"Search by name, member ID, or email...",onKeyup:Q(F,["enter"])},null,544),[[u,w.value]]),e("goa-button",{type:"secondary",size:"compact",on_click:F},"Search",32),w.value?(p(),m("goa-button",{key:0,type:"tertiary",size:"compact",on_click:I},"Clear",32)):_("",!0)]),S.value?_("",!0):(p(),m("div",xe,[e("span",null,a(y.value)+" client"+a(y.value!==1?"s":"")+" found",1)])),e("div",Pe,[e("table",Se,[l[41]||(l[41]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Member ID"),e("th",null,"Email"),e("th",null,"Phone"),e("th",null,"Settlement"),e("th",null,"City"),e("th",null,"Actions")])],-1)),e("tbody",null,[S.value?(p(),m("tr",Ue,[...l[39]||(l[39]=[e("td",{colspan:"7",class:"center-text"},"Loading clients...",-1)])])):b.value.length===0?(p(),m("tr",Ve,[...l[40]||(l[40]=[e("td",{colspan:"7",class:"center-text"},"No clients found",-1)])])):_("",!0),(p(!0),m(j,null,M(b.value,t=>(p(),m("tr",{key:t.id,class:"clickable-row",onClick:f=>R(t.id)},[e("td",Le,a(t.last_name)+", "+a(t.first_name),1),e("td",Ee,a(t.member_id||"—"),1),e("td",null,a(t.email||"—"),1),e("td",null,a(t.phone_cell||t.phone_home||"—"),1),e("td",null,a(t.settlement||"—"),1),e("td",null,a(t.city||"—"),1),e("td",null,[e("goa-button",{type:"tertiary",size:"compact",on_click:B(f=>N(t.id),["stop"])},"Edit",40,ze)])],8,$e))),128))])])]),y.value>k.value?(p(),m("div",Fe,[e("goa-button",{type:"tertiary",size:"compact",disabled:c.value===0,on_click:T},"Previous",40,Ne),e("span",De,"Showing "+a(c.value+1)+"–"+a(Math.min(c.value+k.value,y.value))+" of "+a(y.value),1),e("goa-button",{type:"tertiary",size:"compact",disabled:c.value+k.value>=y.value,on_click:O},"Next",40,je)])):_("",!0),n.value?(p(),m("div",{key:4,class:"detail-overlay",onClick:l[20]||(l[20]=B(t=>n.value=null,["self"]))},[e("div",Me,[e("div",Be,[e("h3",null,a(n.value.first_name)+" "+a(n.value.last_name),1),e("button",{class:"close-btn",onClick:l[18]||(l[18]=t=>n.value=null)},"×")]),e("div",Ae,[e("div",Ie,[l[42]||(l[42]=e("span",{class:"detail-label"},"Member ID",-1)),e("span",null,a(n.value.member_id||"—"),1)]),e("div",Te,[l[43]||(l[43]=e("span",{class:"detail-label"},"Email",-1)),e("span",null,a(n.value.email||"—"),1)]),e("div",Oe,[l[44]||(l[44]=e("span",{class:"detail-label"},"Phone (Home)",-1)),e("span",null,a(n.value.phone_home||"—"),1)]),e("div",Re,[l[45]||(l[45]=e("span",{class:"detail-label"},"Phone (Work)",-1)),e("span",null,a(n.value.phone_work||"—"),1)]),e("div",He,[l[46]||(l[46]=e("span",{class:"detail-label"},"Phone (Cell)",-1)),e("span",null,a(n.value.phone_cell||"—"),1)]),e("div",Je,[l[47]||(l[47]=e("span",{class:"detail-label"},"Settlement",-1)),e("span",null,a(n.value.settlement||"—"),1)]),e("div",Ke,[l[48]||(l[48]=e("span",{class:"detail-label"},"Address",-1)),e("span",null,a(n.value.address_1||"—"),1)]),e("div",qe,[l[49]||(l[49]=e("span",{class:"detail-label"},"City",-1)),e("span",null,a(n.value.city||"—"),1)]),e("div",We,[l[50]||(l[50]=e("span",{class:"detail-label"},"Province",-1)),e("span",null,a(n.value.province||"—"),1)]),e("div",Ge,[l[51]||(l[51]=e("span",{class:"detail-label"},"Postal Code",-1)),e("span",null,a(n.value.postal_code||"—"),1)]),e("div",Qe,[l[52]||(l[52]=e("span",{class:"detail-label"},"Date of Birth",-1)),e("span",null,a(n.value.date_of_birth?new Date(n.value.date_of_birth).toLocaleDateString():"—"),1)]),e("div",Xe,[l[53]||(l[53]=e("span",{class:"detail-label"},"Organization",-1)),e("span",null,a(n.value.org_name||"—"),1)]),e("div",Ye,[l[54]||(l[54]=e("span",{class:"detail-label"},"Job Title",-1)),e("span",null,a(n.value.job_title||"—"),1)]),e("div",Ze,[l[55]||(l[55]=e("span",{class:"detail-label"},"Department",-1)),e("span",null,a(n.value.department||"—"),1)])]),n.value.notes?(p(),m("div",el,[l[56]||(l[56]=e("span",{class:"detail-label"},"Notes",-1)),e("p",null,a(n.value.notes),1)])):_("",!0),e("div",ll,[e("goa-button",{type:"secondary",size:"compact",on_click:l[19]||(l[19]=t=>N(n.value.id))},"Edit",32)])])])):_("",!0)])}}},nl=K(tl,[["__scopeId","data-v-1a6cfae0"]]);export{nl as default};
//# sourceMappingURL=ClientsList-CfuePmJV.js.map
