import{_ as V,o as z,e as C,H as k,a as f,c as m,b as s,g,t as r,w as A,d as _,i as S}from"./index-DxPLqLYP.js";const H={class:"profile"},J={class:"profile-section"},O={class:"section-header"},j={key:0,type:"success",heading:"Success"},G={key:1,type:"emergency",heading:"Error"},K={key:2,class:"info-grid"},Q={class:"info-item"},T={class:"info-value"},U={class:"info-item"},W={class:"info-value"},X={class:"info-item"},Y={class:"info-value"},Z={class:"info-item"},$={class:"info-value"},ss={class:"info-item"},es={class:"info-value"},as={key:3,class:"edit-form"},os=["error"],ts=["value"],rs=["error"],ns=["value"],ls={class:"info-item",style:{"margin-top":"var(--goa-space-s)"}},is={class:"info-value"},us={class:"info-item",style:{"margin-top":"var(--goa-space-s)"}},ds={class:"info-value"},cs={class:"form-actions"},fs=["disabled"],ms={class:"profile-section"},_s={key:0,type:"success",heading:"Success"},vs={key:1,type:"emergency",heading:"Error"},ws=["error"],ps=["value"],gs=["error"],Ps=["value"],hs=["error"],ys=["value"],bs={class:"form-actions"},ks=["disabled"],Ss={__name:"Profile",setup(Cs){const t=_(null),P=_(!1),h=_(""),y=_(""),w=_(!1),b=_(!1),p=_(""),v=_(""),l=S({first_name:"",last_name:""}),i=S({first_name:"",last_name:""}),o=S({currentPassword:"",newPassword:"",confirmPassword:""}),n=S({currentPassword:"",newPassword:"",confirmPassword:""});z(async()=>{try{const a=await C.get("/auth/me");a.success&&(t.value=a.user)}catch{t.value=k.user}});function B(){var a,e;l.first_name=((a=t.value)==null?void 0:a.first_name)||"",l.last_name=((e=t.value)==null?void 0:e.last_name)||"",i.first_name="",i.last_name="",p.value="",v.value="",w.value=!0}function I(){w.value=!1,i.first_name="",i.last_name="",v.value=""}async function D(){var e,c;i.first_name="",i.last_name="",v.value="",p.value="";let a=!0;if(l.first_name.trim()||(i.first_name="First name is required",a=!1),l.last_name.trim()||(i.last_name="Last name is required",a=!1),!!a){b.value=!0;try{const u=await C.put("/auth/profile",{first_name:l.first_name.trim(),last_name:l.last_name.trim()});u.success&&(t.value=u.user,w.value=!1,p.value="Profile updated successfully",k.user={...k.user,first_name:u.user.first_name,last_name:u.user.last_name},localStorage.setItem("msat_user",JSON.stringify(k.user)))}catch(u){v.value=((c=(e=u.response)==null?void 0:e.data)==null?void 0:c.message)||"Failed to update profile"}finally{b.value=!1}}}function E(){h.value="",y.value="",n.currentPassword="",n.newPassword="",n.confirmPassword=""}function R(){let a=!0;return E(),o.currentPassword||(n.currentPassword="Current password is required",a=!1),o.newPassword?o.newPassword.length<6&&(n.newPassword="Password must be at least 6 characters",a=!1):(n.newPassword="New password is required",a=!1),o.confirmPassword?o.newPassword!==o.confirmPassword&&(n.confirmPassword="Passwords do not match",a=!1):(n.confirmPassword="Please confirm your new password",a=!1),a}async function N(){var a,e;if(R()){P.value=!0,E();try{(await C.put("/auth/change-password",{currentPassword:o.currentPassword,newPassword:o.newPassword})).success&&(h.value="Password changed successfully",o.currentPassword="",o.newPassword="",o.confirmPassword="")}catch(c){y.value=((e=(a=c.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to change password"}finally{P.value=!1}}}return(a,e)=>{var c,u,M,F,L,q,x;return f(),m("div",H,[e[14]||(e[14]=s("div",{class:"page-header"},[s("h1",null,"My Profile"),s("p",null,"Manage your account settings")],-1)),s("div",J,[s("div",O,[e[5]||(e[5]=s("h2",null,"Account Information",-1)),w.value?g("",!0):(f(),m("goa-button",{key:0,type:"tertiary",size:"compact",on_click:B}," Edit Profile ",32))]),p.value?(f(),m("goa-callout",j,r(p.value),1)):g("",!0),v.value?(f(),m("goa-callout",G,r(v.value),1)):g("",!0),w.value?(f(),m("div",as,[s("goa-form-item",{label:"First Name",error:i.first_name},[s("goa-input",{name:"first_name",value:l.first_name,on_change:e[0]||(e[0]=d=>l.first_name=d.detail.value),width:"100%"},null,40,ts)],8,os),s("goa-form-item",{label:"Last Name",error:i.last_name},[s("goa-input",{name:"last_name",value:l.last_name,on_change:e[1]||(e[1]=d=>l.last_name=d.detail.value),width:"100%"},null,40,ns)],8,rs),s("div",ls,[e[11]||(e[11]=s("span",{class:"info-label"},"Email",-1)),s("span",is,r((q=t.value)==null?void 0:q.email),1)]),s("div",us,[e[12]||(e[12]=s("span",{class:"info-label"},"Role",-1)),s("span",ds,r((x=t.value)==null?void 0:x.role),1)]),s("div",cs,[s("goa-button",{type:"primary",on_click:D,disabled:b.value},r(b.value?"Saving...":"Save Changes"),41,fs),s("goa-button",{type:"tertiary",on_click:I}," Cancel ",32)])])):(f(),m("div",K,[s("div",Q,[e[6]||(e[6]=s("span",{class:"info-label"},"First Name",-1)),s("span",T,r(((c=t.value)==null?void 0:c.first_name)||"—"),1)]),s("div",U,[e[7]||(e[7]=s("span",{class:"info-label"},"Last Name",-1)),s("span",W,r(((u=t.value)==null?void 0:u.last_name)||"—"),1)]),s("div",X,[e[8]||(e[8]=s("span",{class:"info-label"},"Email",-1)),s("span",Y,r(((M=t.value)==null?void 0:M.email)||"—"),1)]),s("div",Z,[e[9]||(e[9]=s("span",{class:"info-label"},"Role",-1)),s("span",$,r(((F=t.value)==null?void 0:F.role)||"—"),1)]),s("div",ss,[e[10]||(e[10]=s("span",{class:"info-label"},"Last Login",-1)),s("span",es,r((L=t.value)!=null&&L.last_login?new Date(t.value.last_login).toLocaleString():"—"),1)])]))]),s("div",ms,[e[13]||(e[13]=s("h2",null,"Change Password",-1)),h.value?(f(),m("goa-callout",_s,r(h.value),1)):g("",!0),y.value?(f(),m("goa-callout",vs,r(y.value),1)):g("",!0),s("form",{onSubmit:A(N,["prevent"]),class:"password-form"},[s("goa-form-item",{label:"Current Password",error:n.currentPassword},[s("goa-input",{type:"password",name:"currentPassword",value:o.currentPassword,on_change:e[2]||(e[2]=d=>o.currentPassword=d.detail.value),width:"100%"},null,40,ps)],8,ws),s("goa-form-item",{label:"New Password",error:n.newPassword},[s("goa-input",{type:"password",name:"newPassword",value:o.newPassword,on_change:e[3]||(e[3]=d=>o.newPassword=d.detail.value),width:"100%"},null,40,Ps)],8,gs),s("goa-form-item",{label:"Confirm New Password",error:n.confirmPassword},[s("goa-input",{type:"password",name:"confirmPassword",value:o.confirmPassword,on_change:e[4]||(e[4]=d=>o.confirmPassword=d.detail.value),width:"100%"},null,40,ys)],8,hs),s("div",bs,[s("goa-button",{type:"primary",on_click:N,disabled:P.value},r(P.value?"Changing...":"Change Password"),41,ks)])],32)])])}}},Ns=V(Ss,[["__scopeId","data-v-f2242ed1"]]);export{Ns as default};
//# sourceMappingURL=Profile-Ch8VaA6h.js.map
