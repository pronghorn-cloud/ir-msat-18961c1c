import{_ as z,H as A,o as R,a as r,c as i,b as e,t as u,g as _,F as D,r as P,w as I,e as g,d as v,i as C,n as F,J as V}from"./index-DxPLqLYP.js";const H={class:"user-management"},J={key:0,type:"success",heading:"Success"},O={key:1,type:"emergency",heading:"Error"},j={class:"actions-bar"},G={class:"table-container"},K={class:"users-table"},Q={key:0},T={key:1},W={class:"actions-cell"},X=["on_click"],Y=["on_click"],Z=["on_click"],ee={class:"modal-content"},ae={key:0,type:"emergency",heading:"Error"},se=["error"],te=["value","disabled"],le=["error"],oe=["value"],ne=["error"],re=["value"],ie=["error"],ue=["value"],de=["error"],ce=["value"],me={class:"form-actions"},_e=["disabled"],ve={__name:"UserManagement",setup(fe){var E;const y=v([]),k=v(!0),d=v(""),c=v(""),S=(E=A.user)==null?void 0:E.id,b=v(!1),n=v(null),h=v(!1),f=v(""),s=C({email:"",first_name:"",last_name:"",role:"staff",password:""}),o=C({email:"",first_name:"",last_name:"",role:"",password:""});function $(l){return{admin:"Admin",staff:"Staff",board_member:"Board Member",user:"User"}[l]||l}async function p(){var l,t;k.value=!0;try{const a=await g.get("/admin/users");a.success&&(y.value=a.users)}catch(a){c.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to load users"}finally{k.value=!1}}function U(){o.email="",o.first_name="",o.last_name="",o.role="",o.password="",f.value=""}function M(){n.value=null,s.email="",s.first_name="",s.last_name="",s.role="staff",s.password="",U(),d.value="",c.value="",b.value=!0}function B(l){n.value=l,s.email=l.email,s.first_name=l.first_name,s.last_name=l.last_name,s.role=l.role,s.password="",U(),d.value="",c.value="",b.value=!0}function w(){b.value=!1,n.value=null}function L(){U();let l=!0;return!n.value&&!s.email.trim()&&(o.email="Email is required",l=!1),s.first_name.trim()||(o.first_name="First name is required",l=!1),s.last_name.trim()||(o.last_name="Last name is required",l=!1),s.role||(o.role="Role is required",l=!1),!n.value&&!s.password&&(o.password="Password is required",l=!1),!n.value&&s.password&&s.password.length<6&&(o.password="Password must be at least 6 characters",l=!1),l}async function N(){var l,t;if(L()){h.value=!0,f.value="";try{n.value?(await g.put(`/admin/users/${n.value.id}`,{first_name:s.first_name.trim(),last_name:s.last_name.trim(),role:s.role})).success&&(d.value="User updated successfully",w(),await p()):(await g.post("/admin/users",{email:s.email.trim(),first_name:s.first_name.trim(),last_name:s.last_name.trim(),role:s.role,password:s.password})).success&&(d.value="User created successfully",w(),await p())}catch(a){f.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Operation failed"}finally{h.value=!1}}}async function q(l){var t,a;d.value="",c.value="";try{(await g.put(`/admin/users/${l.id}/block`)).success&&(d.value=`${l.first_name} ${l.last_name} has been blocked`,await p())}catch(m){c.value=((a=(t=m.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to block user"}}async function x(l){var t,a;d.value="",c.value="";try{(await g.put(`/admin/users/${l.id}/unblock`)).success&&(d.value=`${l.first_name} ${l.last_name} has been unblocked`,await p())}catch(m){c.value=((a=(t=m.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to unblock user"}}return R(p),(l,t)=>(r(),i("div",H,[t[9]||(t[9]=e("div",{class:"page-header"},[e("h1",null,"User Management"),e("p",null,"Create, edit, and manage user accounts")],-1)),d.value?(r(),i("goa-callout",J,u(d.value),1)):_("",!0),c.value?(r(),i("goa-callout",O,u(c.value),1)):_("",!0),e("div",j,[e("goa-button",{type:"primary",on_click:M}," Create User ",32)]),e("div",G,[e("table",K,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Role"),e("th",null,"Status"),e("th",null,"Last Login"),e("th",null,"Actions")])],-1)),e("tbody",null,[k.value?(r(),i("tr",Q,[...t[5]||(t[5]=[e("td",{colspan:"6",class:"center-text"},"Loading users...",-1)])])):y.value.length===0?(r(),i("tr",T,[...t[6]||(t[6]=[e("td",{colspan:"6",class:"center-text"},"No users found",-1)])])):_("",!0),(r(!0),i(D,null,P(y.value,a=>(r(),i("tr",{key:a.id,class:F({"blocked-row":!a.is_active})},[e("td",null,u(a.first_name)+" "+u(a.last_name),1),e("td",null,u(a.email),1),e("td",null,[e("span",{class:F(["role-badge","role-"+a.role])},u($(a.role)),3)]),e("td",null,[e("span",{class:F(["status-badge",a.is_active?"status-active":"status-blocked"])},u(a.is_active?"Active":"Blocked"),3)]),e("td",null,u(a.last_login?new Date(a.last_login).toLocaleString():"â€”"),1),e("td",W,[e("goa-button",{type:"tertiary",size:"compact",on_click:m=>B(a)}," Edit ",40,X),a.is_active&&a.id!==V(S)?(r(),i("goa-button",{key:0,type:"tertiary",size:"compact",on_click:m=>q(a)}," Block ",40,Y)):_("",!0),a.is_active?_("",!0):(r(),i("goa-button",{key:1,type:"tertiary",size:"compact",on_click:m=>x(a)}," Unblock ",40,Z))])],2))),128))])])]),b.value?(r(),i("div",{key:2,class:"modal-overlay",onClick:I(w,["self"])},[e("div",ee,[e("h2",null,u(n.value?"Edit User":"Create User"),1),f.value?(r(),i("goa-callout",ae,u(f.value),1)):_("",!0),e("goa-form-item",{label:"Email",error:o.email},[e("goa-input",{name:"email",value:s.email,on_change:t[0]||(t[0]=a=>s.email=a.detail.value),width:"100%",disabled:!!n.value},null,40,te)],8,se),e("goa-form-item",{label:"First Name",error:o.first_name},[e("goa-input",{name:"first_name",value:s.first_name,on_change:t[1]||(t[1]=a=>s.first_name=a.detail.value),width:"100%"},null,40,oe)],8,le),e("goa-form-item",{label:"Last Name",error:o.last_name},[e("goa-input",{name:"last_name",value:s.last_name,on_change:t[2]||(t[2]=a=>s.last_name=a.detail.value),width:"100%"},null,40,re)],8,ne),e("goa-form-item",{label:"Role",error:o.role},[e("goa-dropdown",{name:"role",value:s.role,on_change:t[3]||(t[3]=a=>s.role=a.detail.value),width:"100%"},[...t[8]||(t[8]=[e("goa-dropdown-item",{value:"admin",label:"Admin"},null,-1),e("goa-dropdown-item",{value:"staff",label:"Staff"},null,-1),e("goa-dropdown-item",{value:"board_member",label:"Board Member"},null,-1),e("goa-dropdown-item",{value:"user",label:"User"},null,-1)])],40,ue)],8,ie),n.value?_("",!0):(r(),i("goa-form-item",{key:1,label:"Password",error:o.password},[e("goa-input",{type:"password",name:"password",value:s.password,on_change:t[4]||(t[4]=a=>s.password=a.detail.value),width:"100%"},null,40,ce)],8,de)),e("div",me,[e("goa-button",{type:"primary",on_click:N,disabled:h.value},u(h.value?"Saving...":n.value?"Save Changes":"Create User"),41,_e),e("goa-button",{type:"tertiary",on_click:w}," Cancel ",32)])])])):_("",!0)]))}},ge=z(ve,[["__scopeId","data-v-48277e3b"]]);export{ge as default};
//# sourceMappingURL=UserManagement-BbP0hHFW.js.map
