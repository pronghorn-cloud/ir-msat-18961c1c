import{_ as A,o as I,a as n,c as o,b as e,f as x,k as N,N as T,t,g as u,F as M,r as P,w as F,n as B,v as E,e as D,d}from"./index-DxPLqLYP.js";const K={class:"submissions-page"},q={class:"filter-bar"},G={class:"filter-item"},H={key:0,class:"results-count"},J={class:"table-container"},O={class:"submissions-table"},Q={key:0},W={key:1},X=["onClick"],Y={class:"ref-number"},Z={class:"center-text"},ee=["on_click"],se={key:0,class:"pagination"},te=["disabled"],le={class:"page-info"},ae=["disabled"],ie={class:"modal-content"},ne={class:"modal-header"},oe={class:"detail-grid"},ue={class:"detail-item"},de={key:0,class:"detail-item"},ve={class:"detail-item"},re={key:1,class:"detail-item"},ce={key:2,class:"detail-item"},pe={key:3,class:"detail-item"},me={class:"detail-item"},_e={key:4,class:"detail-item"},fe={key:5,class:"detail-item"},be={key:6,class:"detail-item"},ye={class:"detail-section"},ge={class:"description-text"},we={key:0,class:"detail-section"},ke={class:"detail-label"},he={class:"doc-list"},Se={key:1,class:"detail-section"},xe={class:"description-text"},De={class:"review-section"},Re={class:"review-form"},Ce={class:"review-field"},Ne={class:"review-field"},Me={class:"review-actions"},Pe=["disabled"],Fe=["type"],Be={__name:"SubmissionsList",setup(Le){const y=d([]),g=d(!0),r=d(0),p=d(20),v=d(0),w=d(""),l=d(null),m=d([]),_=d(""),f=d(""),k=d(!1),c=d(""),h=d(!1);async function b(){g.value=!0;try{const i=new URLSearchParams;i.set("limit",p.value),i.set("offset",v.value),w.value&&i.set("status",w.value);const s=await D.get(`/submissions?${i.toString()}`);s.success&&(y.value=s.data,r.value=s.total)}catch{y.value=[]}finally{g.value=!1}}async function R(i){try{const s=await D.get(`/submissions/${i.id}`);s.success&&(l.value=s.submission,m.value=s.documents||[],_.value=s.submission.status,f.value=s.submission.staff_notes||"",c.value="")}catch{l.value=i,m.value=[],_.value=i.status,f.value=""}}function C(){l.value=null,m.value=[],c.value=""}async function L(){var i,s;if(l.value){k.value=!0,c.value="";try{const a=await D.patch(`/submissions/${l.value.id}/review`,{status:_.value,staff_notes:f.value||null});a.success&&(h.value=!0,c.value=`Submission updated to ${a.submission.status}`,l.value=a.submission,b())}catch(a){h.value=!1,c.value=((s=(i=a.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to update submission"}finally{k.value=!1}}}function V(){v.value=0,b()}function z(){v.value=Math.max(0,v.value-p.value),b()}function $(){v.value=v.value+p.value,b()}function S(i){return i?new Date(i).toLocaleDateString():"—"}function U(i){return i?i<1024?i+" B":i<1048576?(i/1024).toFixed(1)+" KB":(i/1048576).toFixed(1)+" MB":"0 B"}return I(b),(i,s)=>(n(),o("div",K,[s[24]||(s[24]=e("div",{class:"page-header"},[e("div",null,[e("h1",null,"Public Submissions"),e("p",null,"Review appeals submitted through the public form")])],-1)),e("div",q,[e("div",G,[s[4]||(s[4]=e("label",null,"Status",-1)),x(e("select",{class:"filter-select","onUpdate:modelValue":s[0]||(s[0]=a=>w.value=a),onChange:V},[...s[3]||(s[3]=[T('<option value="" data-v-5b9e7b76>All Statuses</option><option value="Pending" data-v-5b9e7b76>Pending</option><option value="Reviewed" data-v-5b9e7b76>Reviewed</option><option value="Converted" data-v-5b9e7b76>Converted</option><option value="Rejected" data-v-5b9e7b76>Rejected</option>',5)])],544),[[N,w.value]])]),g.value?u("",!0):(n(),o("div",H,t(r.value)+" submission"+t(r.value!==1?"s":""),1))]),e("div",J,[e("table",O,[s[7]||(s[7]=e("thead",null,[e("tr",null,[e("th",null,"Reference"),e("th",null,"Name"),e("th",null,"Settlement"),e("th",null,"Issue Type"),e("th",null,"Status"),e("th",null,"Docs"),e("th",null,"Submitted"),e("th",null,"Actions")])],-1)),e("tbody",null,[g.value?(n(),o("tr",Q,[...s[5]||(s[5]=[e("td",{colspan:"8",class:"center-text"},"Loading submissions...",-1)])])):y.value.length===0?(n(),o("tr",W,[...s[6]||(s[6]=[e("td",{colspan:"8",class:"center-text"},"No submissions found",-1)])])):u("",!0),(n(!0),o(M,null,P(y.value,a=>(n(),o("tr",{key:a.id,class:"clickable-row",onClick:j=>R(a)},[e("td",Y,t(a.reference_number),1),e("td",null,t(a.full_name),1),e("td",null,t(a.settlement),1),e("td",null,t(a.issue_type),1),e("td",null,[e("span",{class:B(["status-badge","status-"+a.status.toLowerCase()])},t(a.status),3)]),e("td",Z,t(a.document_count||0),1),e("td",null,t(S(a.created_at)),1),e("td",null,[e("goa-button",{type:"tertiary",size:"compact",on_click:F(j=>R(a),["stop"])}," View ",40,ee)])],8,X))),128))])])]),r.value>p.value?(n(),o("div",se,[e("goa-button",{type:"tertiary",size:"compact",disabled:v.value===0,on_click:z}," Previous ",40,te),e("span",le,"Showing "+t(v.value+1)+"–"+t(Math.min(v.value+p.value,r.value))+" of "+t(r.value),1),e("goa-button",{type:"tertiary",size:"compact",disabled:v.value+p.value>=r.value,on_click:$}," Next ",40,ae)])):u("",!0),l.value?(n(),o("div",{key:1,class:"modal-overlay",onClick:F(C,["self"])},[e("div",ie,[e("div",ne,[e("h2",null,t(l.value.reference_number),1),e("span",{class:B(["status-badge","status-"+l.value.status.toLowerCase()])},t(l.value.status),3),e("button",{class:"close-btn",onClick:C},"×")]),e("div",oe,[e("div",ue,[s[8]||(s[8]=e("span",{class:"detail-label"},"Full Name",-1)),e("span",null,t(l.value.full_name),1)]),l.value.member_id?(n(),o("div",de,[s[9]||(s[9]=e("span",{class:"detail-label"},"Member ID",-1)),e("span",null,t(l.value.member_id),1)])):u("",!0),e("div",ve,[s[10]||(s[10]=e("span",{class:"detail-label"},"Settlement",-1)),e("span",null,t(l.value.settlement),1)]),l.value.phone?(n(),o("div",re,[s[11]||(s[11]=e("span",{class:"detail-label"},"Phone",-1)),e("span",null,t(l.value.phone),1)])):u("",!0),l.value.email?(n(),o("div",ce,[s[12]||(s[12]=e("span",{class:"detail-label"},"Email",-1)),e("span",null,t(l.value.email),1)])):u("",!0),l.value.address?(n(),o("div",pe,[s[13]||(s[13]=e("span",{class:"detail-label"},"Address",-1)),e("span",null,t(l.value.address),1)])):u("",!0),e("div",me,[s[14]||(s[14]=e("span",{class:"detail-label"},"Issue Type",-1)),e("span",null,t(l.value.issue_type),1)]),l.value.decision_date?(n(),o("div",_e,[s[15]||(s[15]=e("span",{class:"detail-label"},"Decision Date",-1)),e("span",null,t(S(l.value.decision_date)),1)])):u("",!0),l.value.decision_maker?(n(),o("div",fe,[s[16]||(s[16]=e("span",{class:"detail-label"},"Decision Maker",-1)),e("span",null,t(l.value.decision_maker),1)])):u("",!0),l.value.reviewed_by_name?(n(),o("div",be,[s[17]||(s[17]=e("span",{class:"detail-label"},"Reviewed By",-1)),e("span",null,t(l.value.reviewed_by_name)+" ("+t(S(l.value.reviewed_at))+")",1)])):u("",!0)]),e("div",ye,[s[18]||(s[18]=e("span",{class:"detail-label"},"Description",-1)),e("p",ge,t(l.value.description),1)]),m.value.length>0?(n(),o("div",we,[e("span",ke,"Documents ("+t(m.value.length)+")",1),e("ul",he,[(n(!0),o(M,null,P(m.value,a=>(n(),o("li",{key:a.id},t(a.original_name)+" ("+t(U(a.file_size))+") ",1))),128))])])):u("",!0),l.value.staff_notes?(n(),o("div",Se,[s[19]||(s[19]=e("span",{class:"detail-label"},"Staff Notes",-1)),e("p",xe,t(l.value.staff_notes),1)])):u("",!0),e("div",De,[s[23]||(s[23]=e("h3",null,"Review",-1)),e("div",Re,[e("div",Ce,[s[21]||(s[21]=e("label",null,"Update Status",-1)),x(e("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>_.value=a),class:"filter-select"},[...s[20]||(s[20]=[e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Reviewed"},"Reviewed",-1),e("option",{value:"Converted"},"Converted",-1),e("option",{value:"Rejected"},"Rejected",-1)])],512),[[N,_.value]])]),e("div",Ne,[s[22]||(s[22]=e("label",null,"Staff Notes",-1)),x(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=a=>f.value=a),rows:"3",class:"review-textarea",placeholder:"Add notes about this submission..."},null,512),[[E,f.value]])]),e("div",Me,[e("goa-button",{type:"primary",on_click:L,disabled:k.value},t(k.value?"Saving...":"Save Review"),41,Pe)])]),c.value?(n(),o("goa-callout",{key:0,type:h.value?"success":"emergency",class:"review-msg"},t(c.value),9,Fe)):u("",!0)])])])):u("",!0)]))}},ze=A(Be,[["__scopeId","data-v-5b9e7b76"]]);export{ze as default};
//# sourceMappingURL=SubmissionsList-CMOUk-_q.js.map
