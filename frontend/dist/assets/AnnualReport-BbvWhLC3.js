import{_ as M,o as $,a as u,c as i,b as e,K as T,L as C,f as k,k as I,F as _,r as y,g,t as l,p as E,e as A,M as F,d as c,l as L}from"./index-DxPLqLYP.js";const Y={class:"annual-report"},O={class:"page-header"},V={class:"header-row"},x={class:"fy-selector"},N=["value"],B={key:0,class:"loading-msg"},P={key:1,class:"report-content"},U={class:"report-section"},D={class:"summary-grid"},j={class:"summary-item"},G={class:"summary-value"},z={class:"summary-item"},K={class:"summary-value"},q={class:"summary-item"},w={class:"summary-value"},H={class:"summary-item"},J={class:"summary-value"},Q={class:"summary-item"},W={class:"summary-value"},X={class:"report-section"},Z={class:"report-table"},ee={class:"report-section"},se={class:"report-table"},te={class:"report-section"},le={class:"summary-grid"},ae={class:"summary-item"},ne={class:"summary-value"},oe={class:"summary-item"},ue={class:"summary-value"},ie={class:"summary-item"},re={class:"summary-value"},de={class:"report-section"},ce={class:"orders-stat"},me={__name:"AnnualReport",setup(pe){const h=c([]),d=c(null),a=c(null),m=c(!1),p=L(()=>{if(!a.value)return{};const t=a.value.by_settlement;return{settlement_filed:t.reduce((s,o)=>s+o.filed,0),settlement_resolved:t.reduce((s,o)=>s+o.resolved,0),settlement_active:t.reduce((s,o)=>s+o.active,0)}});async function S(){try{const t=await A.get("/analytics/fiscal-years");t.success&&(h.value=t.data,t.data.length>0&&(d.value=t.data[0].value))}catch{}}async function f(){if(d.value){m.value=!0,a.value=null;try{const t=await A.get(`/analytics/annual-report?fy=${d.value}`);t.success&&(a.value=t.data)}catch{}finally{m.value=!1}}}function R(){if(!a.value)return;const t=a.value,s=[];s.push(`MSAT Annual Report — Fiscal Year ${t.fiscal_year}`),s.push(`Generated: ${new Date().toISOString().split("T")[0]}`),s.push(""),s.push("SUMMARY STATISTICS"),s.push("Metric,Value"),s.push(`Appeals Filed,${t.summary.appeals_filed}`),s.push(`Appeals Resolved,${t.summary.appeals_resolved}`),s.push(`Orders Issued,${t.summary.orders_issued}`),s.push(`Avg Resolution Days,${t.summary.avg_resolution_days}`),s.push(`Currently Active Appeals,${t.summary.active_appeals}`),s.push(""),s.push("APPEALS BY SETTLEMENT"),s.push("Settlement,Filed,Resolved,Active"),t.by_settlement.forEach(r=>{s.push(`${r.settlement},${r.filed},${r.resolved},${r.active}`)}),s.push(""),s.push("APPEALS BY ISSUE TYPE"),s.push("Issue Type,Count,Percentage"),t.by_issue_type.forEach(r=>{s.push(`"${r.issue_type}",${r.count},${r.percentage}%`)}),s.push(""),s.push("MEDIATION / CONCILIATION"),s.push("Metric,Value"),s.push(`Cases in Mediation,${t.mediation.cases_in_mediation}`),s.push(`Resolved via Mediation,${t.mediation.resolved_via_mediation}`),s.push(`Mediation Success Rate,${t.mediation.mediation_rate_percent}%`);const o=s.join(`
`),n=new Blob([o],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(n),v=document.createElement("a");v.href=b,v.download=`MSAT_Annual_Report_FY${t.fiscal_year.replace("/","-")}.csv`,v.click(),URL.revokeObjectURL(b)}return $(async()=>{await S(),await f()}),(t,s)=>{const o=F("router-link");return u(),i("div",Y,[e("div",O,[e("div",V,[s[2]||(s[2]=e("div",null,[e("h1",null,"Annual Report Generator"),e("p",null,"Generate statistics for the MSAT Annual Report tabled with the Alberta Legislature")],-1)),T(o,{to:"/dashboard",class:"back-link"},{default:C(()=>[...s[1]||(s[1]=[e("goa-button",{type:"tertiary",size:"compact"},"Back to Dashboard",-1)])]),_:1})])]),e("div",x,[s[3]||(s[3]=e("label",{for:"fy-select"},"Fiscal Year (April 1 – March 31)",-1)),k(e("select",{id:"fy-select",class:"form-select","onUpdate:modelValue":s[0]||(s[0]=n=>d.value=n),onChange:f},[(u(!0),i(_,null,y(h.value,n=>(u(),i("option",{key:n.value,value:n.value},l(n.label),9,N))),128))],544),[[I,d.value]]),e("goa-button",{type:"secondary",size:"compact",on_click:R},"Export to CSV",32)]),m.value?(u(),i("div",B,"Loading report data...")):g("",!0),a.value?(u(),i("div",P,[e("section",U,[e("h2",null,"Summary Statistics — FY "+l(a.value.fiscal_year),1),e("div",D,[e("div",j,[e("span",G,l(a.value.summary.appeals_filed),1),s[4]||(s[4]=e("span",{class:"summary-label"},"Appeals Filed",-1))]),e("div",z,[e("span",K,l(a.value.summary.appeals_resolved),1),s[5]||(s[5]=e("span",{class:"summary-label"},"Appeals Resolved",-1))]),e("div",q,[e("span",w,l(a.value.summary.orders_issued),1),s[6]||(s[6]=e("span",{class:"summary-label"},"Orders Issued",-1))]),e("div",H,[e("span",J,l(a.value.summary.avg_resolution_days),1),s[7]||(s[7]=e("span",{class:"summary-label"},"Avg Resolution (days)",-1))]),e("div",Q,[e("span",W,l(a.value.summary.active_appeals),1),s[8]||(s[8]=e("span",{class:"summary-label"},"Currently Active",-1))])])]),e("section",X,[s[11]||(s[11]=e("h2",null,"Appeals by Settlement",-1)),e("table",Z,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",null,"Settlement"),e("th",null,"Filed"),e("th",null,"Resolved"),e("th",null,"Currently Active")])],-1)),e("tbody",null,[(u(!0),i(_,null,y(a.value.by_settlement,n=>(u(),i("tr",{key:n.settlement},[e("td",null,l(n.settlement),1),e("td",null,l(n.filed),1),e("td",null,l(n.resolved),1),e("td",null,l(n.active),1)]))),128))]),e("tfoot",null,[e("tr",null,[s[9]||(s[9]=e("td",null,[e("strong",null,"Total")],-1)),e("td",null,[e("strong",null,l(p.value.settlement_filed),1)]),e("td",null,[e("strong",null,l(p.value.settlement_resolved),1)]),e("td",null,[e("strong",null,l(p.value.settlement_active),1)])])])])]),e("section",ee,[s[13]||(s[13]=e("h2",null,"Appeals by Issue Type",-1)),e("table",se,[s[12]||(s[12]=e("thead",null,[e("tr",null,[e("th",null,"Issue Type"),e("th",null,"Count"),e("th",null,"Percentage")])],-1)),e("tbody",null,[(u(!0),i(_,null,y(a.value.by_issue_type,n=>(u(),i("tr",{key:n.issue_type},[e("td",null,l(n.issue_type),1),e("td",null,l(n.count),1),e("td",null,l(n.percentage)+"%",1)]))),128))])])]),e("section",te,[s[17]||(s[17]=e("h2",null,"Mediation / Conciliation",-1)),e("div",le,[e("div",ae,[e("span",ne,l(a.value.mediation.cases_in_mediation),1),s[14]||(s[14]=e("span",{class:"summary-label"},"Cases in Mediation",-1))]),e("div",oe,[e("span",ue,l(a.value.mediation.resolved_via_mediation),1),s[15]||(s[15]=e("span",{class:"summary-label"},"Resolved via Mediation",-1))]),e("div",ie,[e("span",re,l(a.value.mediation.mediation_rate_percent)+"%",1),s[16]||(s[16]=e("span",{class:"summary-label"},"Mediation Success Rate",-1))])])]),e("section",de,[s[18]||(s[18]=e("h2",null,"Orders Issued",-1)),e("p",ce,[e("strong",null,l(a.value.summary.orders_issued),1),E(" orders were issued during FY "+l(a.value.fiscal_year)+". ",1)])])])):g("",!0)])}}},_e=M(me,[["__scopeId","data-v-d22d67c3"]]);export{_e as default};
//# sourceMappingURL=AnnualReport-BbvWhLC3.js.map
