import{_ as P,o as I,a as o,c as n,b as e,g as w,j,F as m,r as g,t as u,e as y,d as r,l as E,i as M,n as U,w as V}from"./index-DxPLqLYP.js";const B={class:"appeals-page"},O={class:"page-header"},K={class:"header-row"},Q={class:"header-actions"},q=["disabled"],G={class:"filter-panel"},H={class:"filter-header"},J={class:"filter-row"},W={class:"filter-item"},X=["value"],Y={class:"filter-item"},Z=["value"],ee=["value","label"],te={class:"filter-item"},se=["value"],ae=["value","label"],le={class:"filter-item"},oe=["value"],ne=["value","label"],ie={class:"filter-row"},ue={class:"filter-item"},de=["value"],re=["value","label"],pe={class:"filter-item"},ce=["value"],ve=["value","label"],fe={class:"filter-item"},_e=["value"],me={class:"filter-item"},ge=["value"],ye={class:"filter-actions"},be={key:0,class:"results-summary"},he={class:"table-container"},we={class:"appeals-table"},ke={key:0},Se={key:1},$e=["onClick"],Ae={class:"file-number"},Le=["on_click"],Fe={key:1,class:"pagination"},Ce=["disabled"],De={class:"page-info"},Re=["disabled"],xe={__name:"Appeals",setup(Te){const v=r([]),h=r(!0),f=r(0),_=r(50),i=r(0),k=r([]),S=r([]),$=r([]),A=r([]),L=r([]),a=M({search:"",status:"",stage:"",settlement:"",issue_type:"",staff:"",date_from:"",date_to:""}),F=E(()=>a.search||a.status||a.stage||a.settlement||a.issue_type||a.staff||a.date_from||a.date_to);async function C(){try{const[l,t,s,c,d]=await Promise.all([y.get("/lookups/settlements"),y.get("/lookups/issue-types"),y.get("/lookups/appeal-statuses"),y.get("/lookups/appeal-stages"),y.get("/lookups/staff")]);l.success&&($.value=l.data),t.success&&(A.value=t.data),s.success&&(k.value=s.data),c.success&&(S.value=c.data),d.success&&(L.value=d.data)}catch{}}function D(){const l=new URLSearchParams;return l.set("limit",_.value),l.set("offset",i.value),a.search&&l.set("search",a.search),a.status&&l.set("status",a.status),a.stage&&l.set("stage",a.stage),a.settlement&&l.set("settlement",a.settlement),a.issue_type&&l.set("issue_type",a.issue_type),a.staff&&l.set("staff",a.staff),a.date_from&&l.set("date_from",a.date_from),a.date_to&&l.set("date_to",a.date_to),l.toString()}async function b(){h.value=!0;try{const l=await y.get(`/appeals?${D()}`);l.success&&(v.value=l.data,f.value=l.total)}catch{v.value=[]}finally{h.value=!1}}function p(){i.value=0,b()}function R(){a.search="",a.status="",a.stage="",a.settlement="",a.issue_type="",a.staff="",a.date_from="",a.date_to="",i.value=0,b()}function x(){i.value=Math.max(0,i.value-_.value),b()}function T(){i.value=i.value+_.value,b()}function z(){if(v.value.length===0)return;const l=["File Number,Contact Date,Issue Type,Status,Stage,Primary Staff"];v.value.forEach(d=>{const N=d.contact_date?new Date(d.contact_date).toLocaleDateString():"";l.push([`"${(d.file_number||"").replace(/"/g,'""')}"`,N,`"${(d.issue_type||"").replace(/"/g,'""')}"`,`"${(d.status||"").replace(/"/g,'""')}"`,`"${(d.stage||"").replace(/"/g,'""')}"`,`"${(d.primary_staff||"").replace(/"/g,'""')}"`].join(","))});const t=new Blob([l.join(`
`)],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(t),c=document.createElement("a");c.href=s,c.download=`Appeals_Export_${new Date().toISOString().split("T")[0]}.csv`,c.click(),URL.revokeObjectURL(s)}return I(()=>{C(),b()}),(l,t)=>(o(),n("div",B,[e("div",O,[e("div",K,[t[9]||(t[9]=e("div",null,[e("h1",null,"Appeals"),e("p",null,"Manage appeal cases")],-1)),e("div",Q,[e("goa-button",{type:"secondary",size:"compact",on_click:z,disabled:v.value.length===0}," Export CSV ",40,q),e("goa-button",{type:"primary",on_click:t[0]||(t[0]=s=>l.$router.push("/appeals/new"))}," New Appeal ",32)])])]),e("div",G,[e("div",H,[t[10]||(t[10]=e("span",{class:"filter-title"},"Filters",-1)),F.value?(o(),n("goa-button",{key:0,type:"tertiary",size:"compact",on_click:R}," Clear Filters ",32)):w("",!0)]),e("div",J,[e("div",W,[t[11]||(t[11]=e("label",null,"Search",-1)),e("goa-input",{name:"search",placeholder:"File #, description, staff...",value:a.search,on_change:t[1]||(t[1]=s=>a.search=s.detail.value),onKeyup:j(p,["enter"])},null,40,X)]),e("div",Y,[t[13]||(t[13]=e("label",null,"Status",-1)),e("goa-dropdown",{name:"status",width:"100%",value:a.status,on_change:t[2]||(t[2]=s=>{a.status=s.detail.value,p()})},[t[12]||(t[12]=e("goa-dropdown-item",{value:"",label:"All Statuses"},null,-1)),(o(!0),n(m,null,g(k.value,s=>(o(),n("goa-dropdown-item",{key:s.name,value:s.name,label:s.name},null,8,ee))),128))],40,Z)]),e("div",te,[t[15]||(t[15]=e("label",null,"Stage",-1)),e("goa-dropdown",{name:"stage",width:"100%",value:a.stage,on_change:t[3]||(t[3]=s=>{a.stage=s.detail.value,p()})},[t[14]||(t[14]=e("goa-dropdown-item",{value:"",label:"All Stages"},null,-1)),(o(!0),n(m,null,g(S.value,s=>(o(),n("goa-dropdown-item",{key:s.code,value:s.code,label:s.code},null,8,ae))),128))],40,se)]),e("div",le,[t[17]||(t[17]=e("label",null,"Settlement",-1)),e("goa-dropdown",{name:"settlement",width:"100%",value:a.settlement,on_change:t[4]||(t[4]=s=>{a.settlement=s.detail.value,p()})},[t[16]||(t[16]=e("goa-dropdown-item",{value:"",label:"All Settlements"},null,-1)),(o(!0),n(m,null,g($.value,s=>(o(),n("goa-dropdown-item",{key:s.id,value:String(s.sort_order),label:s.name},null,8,ne))),128))],40,oe)])]),e("div",ie,[e("div",ue,[t[19]||(t[19]=e("label",null,"Issue Type",-1)),e("goa-dropdown",{name:"issue_type",width:"100%",value:a.issue_type,on_change:t[5]||(t[5]=s=>{a.issue_type=s.detail.value,p()})},[t[18]||(t[18]=e("goa-dropdown-item",{value:"",label:"All Issue Types"},null,-1)),(o(!0),n(m,null,g(A.value,s=>(o(),n("goa-dropdown-item",{key:s.name,value:s.name,label:s.name},null,8,re))),128))],40,de)]),e("div",pe,[t[21]||(t[21]=e("label",null,"Staff",-1)),e("goa-dropdown",{name:"staff",width:"100%",value:a.staff,on_change:t[6]||(t[6]=s=>{a.staff=s.detail.value,p()})},[t[20]||(t[20]=e("goa-dropdown-item",{value:"",label:"All Staff"},null,-1)),(o(!0),n(m,null,g(L.value,s=>(o(),n("goa-dropdown-item",{key:s.id,value:s.first_name+" "+s.last_name,label:s.first_name+" "+s.last_name},null,8,ve))),128))],40,ce)]),e("div",fe,[t[22]||(t[22]=e("label",null,"Date From",-1)),e("goa-input",{type:"date",name:"date_from",value:a.date_from,on_change:t[7]||(t[7]=s=>{a.date_from=s.detail.value,p()})},null,40,_e)]),e("div",me,[t[23]||(t[23]=e("label",null,"Date To",-1)),e("goa-input",{type:"date",name:"date_to",value:a.date_to,on_change:t[8]||(t[8]=s=>{a.date_to=s.detail.value,p()})},null,40,ge)])]),e("div",ye,[e("goa-button",{type:"secondary",size:"compact",on_click:p}," Search ",32)])]),h.value?w("",!0):(o(),n("div",be,[e("span",null,u(f.value)+" appeal"+u(f.value!==1?"s":"")+" found",1)])),e("div",he,[e("table",we,[t[26]||(t[26]=e("thead",null,[e("tr",null,[e("th",null,"File Number"),e("th",null,"Contact Date"),e("th",null,"Issue Type"),e("th",null,"Status"),e("th",null,"Stage"),e("th",null,"Primary Staff"),e("th",null,"Actions")])],-1)),e("tbody",null,[h.value?(o(),n("tr",ke,[...t[24]||(t[24]=[e("td",{colspan:"7",class:"center-text"},"Loading appeals...",-1)])])):v.value.length===0?(o(),n("tr",Se,[...t[25]||(t[25]=[e("td",{colspan:"7",class:"center-text"},"No appeals found",-1)])])):w("",!0),(o(!0),n(m,null,g(v.value,s=>(o(),n("tr",{key:s.id,class:"clickable-row",onClick:c=>l.$router.push(`/appeals/${s.id}`)},[e("td",Ae,u(s.file_number),1),e("td",null,u(s.contact_date?new Date(s.contact_date).toLocaleDateString():"—"),1),e("td",null,u(s.issue_type||"—"),1),e("td",null,[e("span",{class:U(["status-badge","status-"+(s.status||"").toLowerCase().replace(/\s+/g,"-")])},u(s.status||"—"),3)]),e("td",null,u(s.stage||"—"),1),e("td",null,u(s.primary_staff||"—"),1),e("td",null,[e("goa-button",{type:"tertiary",size:"compact",on_click:V(c=>l.$router.push(`/appeals/${s.id}`),["stop"])}," View ",40,Le)])],8,$e))),128))])])]),f.value>_.value?(o(),n("div",Fe,[e("goa-button",{type:"tertiary",size:"compact",disabled:i.value===0,on_click:x}," Previous ",40,Ce),e("span",De,"Showing "+u(i.value+1)+"–"+u(Math.min(i.value+_.value,f.value))+" of "+u(f.value),1),e("goa-button",{type:"tertiary",size:"compact",disabled:i.value+_.value>=f.value,on_click:T}," Next ",40,Re)])):w("",!0)]))}},Ne=P(xe,[["__scopeId","data-v-9c46abd9"]]);export{Ne as default};
//# sourceMappingURL=Appeals-C9QIIHx6.js.map
