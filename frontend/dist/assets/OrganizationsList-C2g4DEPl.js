import{_ as W,o as X,a as d,c as p,b as e,t as n,p as Y,f as v,v as m,k as R,F as T,r as E,g as _,n as L,j as Z,w as D,e as w,d as u}from"./index-DxPLqLYP.js";const ee={class:"orgs-page"},le={class:"page-header"},te={class:"header-row"},ae={class:"header-actions"},se=["disabled"],ne={key:0,class:"org-form-panel"},oe={class:"org-form-grid"},ie={class:"form-field",style:{"grid-column":"span 2"}},ue={class:"form-field"},re=["value"],de={class:"form-field"},pe={class:"form-field"},ve={class:"form-field"},ce={class:"form-field",style:{"grid-column":"span 2"}},me={class:"form-field",style:{"grid-column":"span 2"}},fe={class:"form-field",style:{"grid-column":"span 2"}},ye={class:"form-field"},ge={class:"form-field"},be={class:"form-field"},_e={class:"form-actions"},he=["disabled"],ke={class:"search-bar"},ze=["value"],xe={key:2,class:"results-summary"},Ce={class:"table-container"},we={class:"orgs-table"},Oe={key:0},Se={key:1},Ue=["onClick"],Ve={class:"org-name"},$e=["on_click"],Fe={key:3,class:"pagination"},Pe=["disabled"],Te={class:"page-info"},Ee=["disabled"],Le={class:"detail-panel"},Ae={class:"detail-header"},Ne={class:"detail-type-row"},Be={class:"detail-grid"},Me={class:"detail-item"},je={class:"detail-item"},Re={class:"detail-item"},De={class:"detail-item"},Ie={class:"detail-item"},Ke={class:"detail-item"},qe={class:"detail-item"},Ge={class:"detail-item"},Qe={class:"detail-actions"},He={__name:"OrganizationsList",setup(Je){const f=u([]),O=u(!0),y=u(0),h=u(25),c=u(0),z=u(""),S=u(""),x=u(""),U=u(""),k=u(!1),g=u(null),i=u(null),V=u(""),A=u(!1),N=["Settlement","Council","Government Body","Other"],B=()=>({name:"",type:"Other",address_1:"",address_2:"",city:"",province:"AB",postal_code:"",phone:"",fax:"",toll_free:"",email:""}),s=u(B());function M(o){return(o||"other").toLowerCase().replace(/\s+/g,"-")}function I(o){const l=[o.address_1,o.address_2].filter(Boolean);return l.length>0?l.join(", "):"—"}function C(o,l=!1){V.value=o,A.value=l,setTimeout(()=>{V.value=""},3e3)}async function b(){O.value=!0;try{const o=new URLSearchParams;o.set("limit",h.value),o.set("offset",c.value),S.value&&o.set("search",S.value),U.value&&o.set("type",U.value);const l=await w.get(`/organizations?${o.toString()}`);l.success&&(f.value=l.data,y.value=l.total)}catch{f.value=[]}finally{O.value=!1}}function $(){S.value=z.value.trim(),U.value=x.value,c.value=0,b()}function K(){z.value="",x.value="",S.value="",U.value="",c.value=0,b()}function q(){c.value=Math.max(0,c.value-h.value),b()}function G(){c.value=c.value+h.value,b()}async function Q(o){var l,r;try{const t=await w.get(`/organizations/${o}`);t.success&&(i.value=t.organization)}catch(t){C(((r=(l=t.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to load organization",!0)}}async function j(o){var l,r;try{const t=await w.get(`/organizations/${o}`);if(t.success){const a=t.organization;g.value=a.id,i.value=null,k.value=!1,s.value={name:a.name||"",type:a.type||"Other",address_1:a.address_1||"",address_2:a.address_2||"",city:a.city||"",province:a.province||"AB",postal_code:a.postal_code||"",phone:a.phone||"",fax:a.fax||"",toll_free:a.toll_free||"",email:a.email||""}}}catch(t){C(((r=(l=t.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to load organization",!0)}}async function H(){var l,r,t;if(!((l=s.value.name)!=null&&l.trim()))return;const o={};for(const[a,P]of Object.entries(s.value))P!==""&&P!==null&&(o[a]=P);try{if(g.value){const a=await w.patch(`/organizations/${g.value}`,o);a.success&&(C(a.message),F(),b())}else{const a=await w.post("/organizations",o);a.success&&(C(a.message),F(),b())}}catch(a){C(((t=(r=a.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to save organization",!0)}}function F(){k.value=!1,g.value=null,s.value=B()}function J(){if(f.value.length===0)return;const o=["Name,Type,City,Province,Phone,Email"];f.value.forEach(a=>{o.push([`"${(a.name||"").replace(/"/g,'""')}"`,`"${(a.type||"").replace(/"/g,'""')}"`,`"${(a.city||"").replace(/"/g,'""')}"`,`"${(a.province||"").replace(/"/g,'""')}"`,`"${(a.phone||"").replace(/"/g,'""')}"`,`"${(a.email||"").replace(/"/g,'""')}"`].join(","))});const l=new Blob([o.join(`
`)],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(l),t=document.createElement("a");t.href=r,t.download=`Organizations_Export_${new Date().toISOString().split("T")[0]}.csv`,t.click(),URL.revokeObjectURL(r)}return X(()=>{b()}),(o,l)=>{var r;return d(),p("div",ee,[e("div",le,[e("div",te,[l[17]||(l[17]=e("div",null,[e("h1",null,"Organizations"),e("p",null,"Manage organization records")],-1)),e("div",ae,[e("goa-button",{type:"secondary",size:"compact",on_click:J,disabled:f.value.length===0}," Export CSV ",40,se),e("goa-button",{type:"primary",on_click:l[0]||(l[0]=t=>k.value=!k.value)},n(k.value?"Cancel":"New Organization"),33)])])]),k.value||g.value?(d(),p("div",ne,[e("h3",null,n(g.value?"Edit Organization":"New Organization"),1),e("div",oe,[e("div",ie,[l[18]||(l[18]=e("label",null,[Y("Name "),e("span",{class:"required"},"*")],-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[1]||(l[1]=t=>s.value.name=t),placeholder:"Organization name"},null,512),[[m,s.value.name]])]),e("div",ue,[l[19]||(l[19]=e("label",null,"Type",-1)),v(e("select",{class:"form-input","onUpdate:modelValue":l[2]||(l[2]=t=>s.value.type=t)},[(d(),p(T,null,E(N,t=>e("option",{key:t,value:t},n(t),9,re)),64))],512),[[R,s.value.type]])]),e("div",de,[l[20]||(l[20]=e("label",null,"Phone",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[3]||(l[3]=t=>s.value.phone=t),placeholder:"Phone number"},null,512),[[m,s.value.phone]])]),e("div",pe,[l[21]||(l[21]=e("label",null,"Toll Free",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[4]||(l[4]=t=>s.value.toll_free=t),placeholder:"Toll-free number"},null,512),[[m,s.value.toll_free]])]),e("div",ve,[l[22]||(l[22]=e("label",null,"Fax",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[5]||(l[5]=t=>s.value.fax=t),placeholder:"Fax number"},null,512),[[m,s.value.fax]])]),e("div",ce,[l[23]||(l[23]=e("label",null,"Email",-1)),v(e("input",{type:"email",class:"form-input","onUpdate:modelValue":l[6]||(l[6]=t=>s.value.email=t),placeholder:"email@example.com"},null,512),[[m,s.value.email]])]),e("div",me,[l[24]||(l[24]=e("label",null,"Address Line 1",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[7]||(l[7]=t=>s.value.address_1=t),placeholder:"Street address"},null,512),[[m,s.value.address_1]])]),e("div",fe,[l[25]||(l[25]=e("label",null,"Address Line 2",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[8]||(l[8]=t=>s.value.address_2=t),placeholder:"Suite, unit, etc."},null,512),[[m,s.value.address_2]])]),e("div",ye,[l[26]||(l[26]=e("label",null,"City",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[9]||(l[9]=t=>s.value.city=t),placeholder:"City"},null,512),[[m,s.value.city]])]),e("div",ge,[l[27]||(l[27]=e("label",null,"Province",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[10]||(l[10]=t=>s.value.province=t),placeholder:"AB"},null,512),[[m,s.value.province]])]),e("div",be,[l[28]||(l[28]=e("label",null,"Postal Code",-1)),v(e("input",{type:"text",class:"form-input","onUpdate:modelValue":l[11]||(l[11]=t=>s.value.postal_code=t),placeholder:"T0A 0A0"},null,512),[[m,s.value.postal_code]])])]),e("div",_e,[e("goa-button",{type:"primary",size:"compact",disabled:!((r=s.value.name)!=null&&r.trim()),on_click:H},n(g.value?"Save Changes":"Create Organization"),41,he),e("goa-button",{type:"tertiary",size:"compact",on_click:F},"Cancel",32)])])):_("",!0),V.value?(d(),p("div",{key:1,class:L(["feedback",A.value?"feedback-error":"feedback-success"])},n(V.value),3)):_("",!0),e("div",ke,[v(e("input",{type:"text",class:"search-input-large","onUpdate:modelValue":l[12]||(l[12]=t=>z.value=t),placeholder:"Search by organization name...",onKeyup:Z($,["enter"])},null,544),[[m,z.value]]),v(e("select",{class:"type-filter","onUpdate:modelValue":l[13]||(l[13]=t=>x.value=t),onChange:$},[l[29]||(l[29]=e("option",{value:""},"All Types",-1)),(d(),p(T,null,E(N,t=>e("option",{key:t,value:t},n(t),9,ze)),64))],544),[[R,x.value]]),e("goa-button",{type:"secondary",size:"compact",on_click:$},"Search",32),z.value||x.value?(d(),p("goa-button",{key:0,type:"tertiary",size:"compact",on_click:K},"Clear",32)):_("",!0)]),O.value?_("",!0):(d(),p("div",xe,[e("span",null,n(y.value)+" organization"+n(y.value!==1?"s":"")+" found",1)])),e("div",Ce,[e("table",we,[l[32]||(l[32]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Type"),e("th",null,"City"),e("th",null,"Province"),e("th",null,"Phone"),e("th",null,"Email"),e("th",null,"Actions")])],-1)),e("tbody",null,[O.value?(d(),p("tr",Oe,[...l[30]||(l[30]=[e("td",{colspan:"7",class:"center-text"},"Loading organizations...",-1)])])):f.value.length===0?(d(),p("tr",Se,[...l[31]||(l[31]=[e("td",{colspan:"7",class:"center-text"},"No organizations found",-1)])])):_("",!0),(d(!0),p(T,null,E(f.value,t=>(d(),p("tr",{key:t.id,class:"clickable-row",onClick:a=>Q(t.id)},[e("td",Ve,n(t.name),1),e("td",null,[e("span",{class:L(["type-badge","type-"+M(t.type)])},n(t.type),3)]),e("td",null,n(t.city||"—"),1),e("td",null,n(t.province||"—"),1),e("td",null,n(t.phone||"—"),1),e("td",null,n(t.email||"—"),1),e("td",null,[e("goa-button",{type:"tertiary",size:"compact",on_click:D(a=>j(t.id),["stop"])},"Edit",40,$e)])],8,Ue))),128))])])]),y.value>h.value?(d(),p("div",Fe,[e("goa-button",{type:"tertiary",size:"compact",disabled:c.value===0,on_click:q},"Previous",40,Pe),e("span",Te,"Showing "+n(c.value+1)+"–"+n(Math.min(c.value+h.value,y.value))+" of "+n(y.value),1),e("goa-button",{type:"tertiary",size:"compact",disabled:c.value+h.value>=y.value,on_click:G},"Next",40,Ee)])):_("",!0),i.value?(d(),p("div",{key:4,class:"detail-overlay",onClick:l[16]||(l[16]=D(t=>i.value=null,["self"]))},[e("div",Le,[e("div",Ae,[e("h3",null,n(i.value.name),1),e("button",{class:"close-btn",onClick:l[14]||(l[14]=t=>i.value=null)},"×")]),e("div",Ne,[e("span",{class:L(["type-badge","type-"+M(i.value.type)])},n(i.value.type),3)]),e("div",Be,[e("div",Me,[l[33]||(l[33]=e("span",{class:"detail-label"},"Phone",-1)),e("span",null,n(i.value.phone||"—"),1)]),e("div",je,[l[34]||(l[34]=e("span",{class:"detail-label"},"Toll Free",-1)),e("span",null,n(i.value.toll_free||"—"),1)]),e("div",Re,[l[35]||(l[35]=e("span",{class:"detail-label"},"Fax",-1)),e("span",null,n(i.value.fax||"—"),1)]),e("div",De,[l[36]||(l[36]=e("span",{class:"detail-label"},"Email",-1)),e("span",null,n(i.value.email||"—"),1)]),e("div",Ie,[l[37]||(l[37]=e("span",{class:"detail-label"},"Address",-1)),e("span",null,n(I(i.value)),1)]),e("div",Ke,[l[38]||(l[38]=e("span",{class:"detail-label"},"City",-1)),e("span",null,n(i.value.city||"—"),1)]),e("div",qe,[l[39]||(l[39]=e("span",{class:"detail-label"},"Province",-1)),e("span",null,n(i.value.province||"—"),1)]),e("div",Ge,[l[40]||(l[40]=e("span",{class:"detail-label"},"Postal Code",-1)),e("span",null,n(i.value.postal_code||"—"),1)])]),e("div",Qe,[e("goa-button",{type:"secondary",size:"compact",on_click:l[15]||(l[15]=t=>j(i.value.id))},"Edit",32)])])])):_("",!0)])}}},Xe=W(He,[["__scopeId","data-v-11b62cc3"]]);export{Xe as default};
//# sourceMappingURL=OrganizationsList-C2g4DEPl.js.map
